var $=jQuery.noConflict();jQuery(function(a){a(document).on("click","#add-new-eps",function(){var b=a(this).data("ep-total"),c=b+1;a(this).data("ep-total",c);var d=a(this).data("server"),e="<div class=\"halimmovies_episodes episodes_"+c+" row\" data-ep=\""+c+"\" data-server=\""+d+"\"><div class=\"form-group col-lg-1\" style=\"margin-right: -1px\"><label for=\"halimmovies_ep_name_"+d+"_"+c+"\">Episode Name</label><input id=\"halimmovies_ep_name_"+d+"_"+c+"\" name=\"halimmovies_ep_name[]\" type=\"text\" class=\"form-control\" value=\""+c+"\" placeholder=\"Episode name\"></div><div class=\"form-group col-lg-1\" style=\"margin-right: -1px\"><label for=\"halimmovies_ep_slug_"+d+"_"+c+"\">Episode Slug</label><input id=\"halimmovies_ep_slug\" type=\"text\" class=\"form-control\" name=\"halimmovies_ep_slug[]\" value=\""+episode_slug_default+"-"+c+"\" placeholder=\"Episode Slug\"></div><div class=\"form-group col-lg-2\" style=\"margin-right: -1px\"><label>Type: </label><select name=\"halimmovies_ep_type[]\" id=\"halimmovies_ep_type_"+d+"_"+c+"\" style=\"display:block;width:100%;margin-top: 1px;height: 32px;\">"+episode_type+"</select></div><div class=\"form-group col-lg-8\"><label for=\"halimmovies_ep_link_"+d+"_"+c+"\">Link: </label><input class=\"form-control\" type=\"text\" id=\"halimmovies_ep_link_"+d+"_"+c+"\" name=\"halimmovies_ep_link[]\" style=\"width:100%\" value=\"\" placeholder=\"Episode link\"/></div><a class=\"del_ep\"><span class=\"dashicons dashicons-no\"></span></a><div class=\"clearfix\"></div></div>";a("#halimmovies_episodes").append(e)}),a(document).on("click",".del_ep",function(){a(this).parent(".halimmovies_episodes").remove()});var b=current_subtitle_count-1;a(document).on("click",".add_new_sub",function(){var c=a(this).data("server"),d=a(this).data("ep");b++;var e="<div class=\"halimmovies_subs\" style=\"margin-bottom: 10px\"><label>Label: </label> <input  type=\"text\" name=\"sub_label[]\" style=\"width:15%\" value=\"\" placeholder=\"Vietnamese\"/><input id=\"sub_label_default_"+c+"_"+b+"\" type=\"radio\" name=\"sub_default[]\" value=\""+b+"\"><label for=\"sub_label_default_"+c+"_"+b+"\">Default</label><span><label style=\"margin-left: 1%;\">File: </label> <input type=\"text\" name=\"sub_file[]\" style=\"width:69.77%\" value=\"\" placeholder=\"http://example.com/files/subtitle/vietnamese.srt\"/><a class=\"del_sub\" style=\"padding: 4.5px 5px;top: -5px;\"><span class=\"dashicons dashicons-no\"></span></a><span class=\"sortable\"><span class=\"dashicons dashicons-move\"></span></span></span></div>";a(".halimmovies_episodes").find("#halimmovies_subs").append(e),a(".add-new-subtitle").show(),a(".list-subtitle").css("padding-bottom","30px")}),a(document).on("click",".del_sub",function(){a(this).parent().parent(".halimmovies_subs").remove()}),a(document).on("click",".add_new_listsv",function(){var b=a(this).data("server"),c=a(this).data("ep"),d="<div class=\"halimmovies_listsv\" style=\"margin-bottom: 10px\"><label>Name: </label> <input placeholder=\"Server name\" type=\"text\" name=\"listsv_name[]\" style=\"width:15%\" value=\"#\" /><label>Type: </label><select name=\"listsv_type[]\" id=\"listsv_type\">"+episode_type+"</select><label>Link: </label> <input type=\"text\" name=\"listsv_link[]\" style=\"width:71%\" value=\"\" placeholder=\"Alternative video url\"/><a class=\"del_listsv\"><span class=\"dashicons dashicons-no\"></span></a></div>";a(".halimmovies_episodes").find("#halimmovies_listsv").append(d),a("#add-list-sv").show()}),a(document).on("click",".del_listsv",function(){a(this).parent(".halimmovies_listsv").remove()});a("textarea#import-multi-episode, #multiple-import-list, #addnewsv-list").attr("placeholder","EP 1|https://drive.google.com/file/d/1ATilCtX62rLXwpo7Gm7h2ba6wiGjbL3I/view|link \nEP 2|https://drive.google.com/file/d/1ATilCtX62rLXwpo7Gm7h2ba6wiGjbL3I/view|embed"),a("textarea#import-multi-episode, #multiple-import-list, #addnewsv-list").focus(function(){a(this).val()==="EP 1|https://drive.google.com/file/d/1ATilCtX62rLXwpo7Gm7h2ba6wiGjbL3I/view|link \nEP 2|https://drive.google.com/file/d/1ATilCtX62rLXwpo7Gm7h2ba6wiGjbL3I/view|embed"&&a(this).attr("placeholder","")}),a("#category_select, #country_select, #release_select, #status_select, #formality_select, #orderby_select").on("change",function(){var b=a(this).val();return b&&(window.location=b),!1}),a(".publish_post").click(function(){var b=this,c=a(b).data("post-id");a(b).find(".publish-post-btn").addClass("loading"),a.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_publish_post",post_id:c},success:function(c){!0==c.status?(a(b).find(".publish-post-btn").removeClass("dashicons-update-alt loading").addClass("dashicons-yes-alt"),a(b).parent().html("<strong>Publish</strong>")):a(b).parent().html("<strong>Error!</strong>")}})}),a("#add-server").click(function(){var b=a("#add-first-server input[name=server_name]").val(),c=a(document).find("input[name=\"halimmovies_ep_name[]\"]").map(function(){return a(this).val()}).get(),d=a(document).find("input[name=\"halimmovies_ep_slug[]\"]").map(function(){return a(this).val()}).get(),e=a(document).find("input[name=\"halimmovies_ep_link[]\"]").map(function(){return a(this).val()}).get(),f=[];a("select[name=\"halimmovies_ep_type[]\"] option:selected").each(function(){f.push(a(this).val())});var g=a(this).data("server");a("#add-server > span").removeClass("dashicons-plus").addClass("dashicons-image-rotate loading"),a.ajax({type:"POST",url:ajax_url,data:{action:"halim_add_server",post_id:post_id,server:g,server_name:b,halimmovies_ep_name:c,halimmovies_ep_slug:d,halimmovies_ep_link:e,halimmovies_ep_type:f},success:function(){a("#add-server > span").removeClass("dashicons-image-rotate loading").addClass("dashicons-yes"),setTimeout(function(){window.location="?page=halim-episode-manager&act=edit_ep&post_id="+post_id+"&server="+g},500)}})}),a(".del-server").click(function(){var b=a(this).data("index"),c=this;confirm("Are you sure you want to delete this server & all episodes?")&&a.ajax({type:"POST",url:ajax_url,data:{action:"halim_delete_server",post_id:post_id,server:b},success:function(){a(c).closest(".svitem").addClass("fadeout-tomato"),a(c).closest(".svitem").fadeOut(800,function(){a(this).remove()}),setTimeout(function(){location.reload()},1500)}})}),a("#add-eps").click(function(){var b=a("input[name=halimmovies_server_name]").val(),c=a(document).find("input[name=\"halimmovies_ep_name[]\"]").map(function(){return a(this).val()}).get(),d=a(document).find("input[name=\"halimmovies_ep_slug[]\"]").map(function(){return a(this).val()}).get(),e=a(document).find("input[name=\"halimmovies_ep_link[]\"]").map(function(){return a(this).val()}).get(),f=a(document).find("input[name=\"episode_number[]\"]").map(function(){return a(this).val()}).get(),g=[];a("select[name=\"halimmovies_ep_type[]\"] option:selected").each(function(){g.push(a(this).val())}),a("#add-eps").html("Adding..."),a.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_add_episode",post_id:post_id,server:server,halimmovies_server_name:b,halimmovies_ep_name:c,halimmovies_ep_slug:d,halimmovies_ep_link:e,halimmovies_ep_type:g},success:function(){a("#add-eps").html("&#10003; Done!"),setTimeout(function(){},800)}})}),a("#update-eps").click(function(){var b=a("input[name=halimmovies_ep_name]").val(),c=a("input[name=halimmovies_ep_slug]").val(),d=a("input[name=halimmovies_ep_link]").val(),e=a("select[name=\"halimmovies_ep_type\"] option:selected").val(),f=a("#episode_slug").data("old-ep");a("#update-eps > span").addClass("loading"),a.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_update_ep",server:server,post_id:post_id,ep_slug:c,ep_name:b,ep_link:d,ep_type:e,old_ep:f},success:function(){a("#update-eps > span").removeClass("loading").addClass("dashicons-yes"),a(".disable-add-new-ep").remove()}})}),a("body").on("click",".halim-episode-saving",function(){var b=this,c=a(document).find("#list--episodes input[name=\"halimmovies_ep_name[]\"]").map(function(){return a(this).val()}).get(),d=a(document).find("#list--episodes input[name=\"halimmovies_ep_slug[]\"]").map(function(){return a(this).val()}).get(),e=a(document).find("#list--episodes input[name=\"halimmovies_ep_link[]\"]").map(function(){return a(this).val()}).get(),f=a(document).find("#list--episodes input[name=\"halim_server_name\"]").val(),g=[];a("#list--episodes select[name=\"halimmovies_ep_type[]\"] option:selected").each(function(){g.push(a(this).val())}),a(b).html("<span class=\"dashicons dashicons-image-rotate loading\"></span> Updating..."),a.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_update_ep",post_id:post_id,server:server,server_name:f,halimmovies_ep_name:c,halimmovies_ep_slug:d,halimmovies_ep_link:e,halimmovies_ep_type:g},success:function(){a(b).html("&#10003; Done!"),setTimeout(function(){a(b).html("Update episodes")},1200)}})}),a(".update-list-sv").click(function(){var b=this,c=a(b).data("ep-slug"),d=a(document).find("#list-server-"+c).find("input[name=\"listsv_name[]\"]").map(function(){return a(this).val()}).get(),e=a(document).find("#list-server-"+c).find("input[name=\"listsv_link[]\"]").map(function(){return a(this).val()}).get(),f=[];a("#list-server-"+c+" select[name=\"listsv_type[]\"] option:selected").each(function(){f.push(a(this).val())}),a(".update-list-sv").find("span").addClass("loading"),a.ajax({type:"POST",url:ajax_url,data:{action:"halim_update_listsv",post_id:post_id,server:server,episode_slug:c,listsv_name:d,listsv_link:e,listsv_type:f},success:function(){a(".update-list-sv").find("span").removeClass("loading").addClass("dashicons-yes")}})}),a("body").on("click",".update-subtitle",function(){var b=this,c=a(b).data("ep-slug"),d=a(document).find("#list-subtitle-"+c).find("input[name=\"sub_label[]\"]").map(function(){return a(this).val()}).get(),e=a(document).find("#list-subtitle-"+c).find("input[name=\"sub_file[]\"]").map(function(){return a(this).val()}).get(),f=a(document).find("#list-subtitle-"+c).find("input[name=\"sub_default[]\"]:checked").map(function(){return a(this).val()}).get();a(b).html("<span class=\"dashicons dashicons-image-rotate loading\"></span> Updating..."),a.ajax({type:"POST",url:ajax_url,data:{action:"halim_update_subtitle",post_id:post_id,server:server,episode_slug:c,sub_label:d,sub_file:e,sub_default:f},success:function(){a(b).html("&#10003; Done!"),setTimeout(function(){a(b).html("Update")},1200)}})})});function fastImport(){var a=$("#import-multi-episode").val().split(/\r?\n/);$("#result").show().html("Please wait..."),$.ajax({url:ajax_url,type:"POST",data:{action:"halim_ajax_fast_import_episode",post_id:post_id,server:server,list_link:a},success:function(){$("#result").show().html("Import successfuly! <a href=\"?page=halim-episode-manager&act=edit_ep&post_id="+post_id+"&server="+server+"&episode=1&paged=1\">Edit Episode</a>")}})}function setMessage(a){$("#message").html(a),$("#message").show()}function halim_ImportEPS(){$("#halim_data_rebuild").prop("disabled",!0),setMessage("Reading data...");var list_link=$("#import-multi-episode").val().split(/\r?\n/);$.ajax({url:ajax_url,type:"POST",data:"action=halim_ajax_import_episode&do=getList&list_link="+list_link+"&post_id="+post_id+"&server="+server,success:function(result){function pushItem(){return curr>=list.length?($("#halim_data_rebuild").prop("disabled",!1),$("#status p:first-child").addClass("ok"),void setMessage("Done!")):void(setMessage("Importing "+(curr+1)+" of "+list.length+" (Episode "+list[curr].ep_name+")..."),$.ajax({url:ajax_url,type:"POST",data:{action:"halim_ajax_import_episode",do:"insertEpisode",post_id:post_id,server:server,ep_name:list[curr].ep_name,ep_link:list[curr].ep_link,ep_type:list[curr].ep_type},success:function(a){++curr,"-1"!=a&&$("#status").show().prepend("<p><span style=\"color:#46b450;font-size: 17px;font-weight: bold;\">\u2713</span> "+a+"</p>"),pushItem()}}))}var list=eval(result),curr=0;return list?void pushItem():(setMessage("No data found!"),void $("#halim_data_rebuild").prop("disabled",!1))},error:function(a){setMessage("Error "+a.status)}})}$(".halim-list-eps, #halimmovies_listsv, #halimmovies_subs").sortable({placeholder:"slide-placeholder",axis:"y",revert:150,start:function(a,b){placeholderHeight=b.item.outerHeight(),b.placeholder.height(placeholderHeight+15),$("<div class=\"slide-placeholder-animator\" data-height=\""+placeholderHeight+"\"></div>").insertAfter(b.placeholder)},change:function(a,b){b.placeholder.stop().height(0).animate({height:b.item.outerHeight()+15},300),placeholderAnimatorHeight=parseInt($(".slide-placeholder-animator").attr("data-height")),$(".slide-placeholder-animator").stop().height(placeholderAnimatorHeight+15).animate({height:0},300,function(){$(this).remove(),placeholderHeight=b.item.outerHeight(),$("<div class=\"slide-placeholder-animator\" data-height=\""+placeholderHeight+"\"></div>").insertAfter(b.placeholder)})},stop:function(){$(".slide-placeholder-animator").remove()}});